<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>LapisOS documentation</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Documents for LapisOS">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="FOREWORD.html"><strong aria-hidden="true">1.</strong> Foreword</a></li><li class="chapter-item expanded "><a href="FAQ.html"><strong aria-hidden="true">2.</strong> FAQ</a></li><li class="chapter-item expanded "><a href="project/index.html"><strong aria-hidden="true">3.</strong> Project</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="project/development.html"><strong aria-hidden="true">3.1.</strong> Development</a></li></ol></li><li class="chapter-item expanded "><a href="concepts/index.html"><strong aria-hidden="true">4.</strong> Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="concepts/applications.html"><strong aria-hidden="true">4.1.</strong> What are applications?</a></li><li class="chapter-item expanded "><a href="concepts/libraries.html"><strong aria-hidden="true">4.2.</strong> What are libraries?</a></li><li class="chapter-item expanded "><a href="concepts/users.html"><strong aria-hidden="true">4.3.</strong> What are users?</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">LapisOS documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/lapis-org/docs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="foreword"><a class="header" href="#foreword">Foreword</a></h1>
<ul>
<li><a href="FOREWORD.html#foreword">Foreword</a>
<ul>
<li><a href="FOREWORD.html#welcome">Welcome!</a>
<ul>
<li><a href="FOREWORD.html#what-is-lapisos">What is LapisOS?</a></li>
<li><a href="FOREWORD.html#whats-the-projects-structure">What's the project's structure?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="welcome"><a class="header" href="#welcome">Welcome!</a></h2>
<p>Welcome to the documentation of LapisOS!
These documents will show you how the system is designed,
how it works and what it can offer the end user.</p>
<p><strong>Before reading these documents, consider that</strong>
I'm developing this project on my own and am not an expert.</p>
<p>This means that there may be mistakes in low-level documents.
If you find a mistake, feel free to <a href="https://github.com/lapis-org/docs/issues/new/choose">submit an issue</a>.</p>
<h3 id="what-is-lapisos"><a class="header" href="#what-is-lapisos">What is LapisOS?</a></h3>
<p>LapisOS is an operating system that aims to replace
legacy systems such as macOS, Linux, and Windows.
Of course, we know how Windows/macOS/Linux are
installed on today's devices. Therefore, LapisOS
is a theoretical operating system that shows how
an operating system that does not provide backward
compatibility with older architectures will look like.</p>
<h3 id="whats-the-projects-structure"><a class="header" href="#whats-the-projects-structure">What's the project's structure?</a></h3>
<p>The project consists of three different parts:
<em>the kernel</em>, <em>the system</em> and <em>the desktop environment</em>.</p>
<p><strong>The kernel</strong> basically allows software to access hardware.
It is a microkernel, so unlike a monolithic kernel
like Linux, potential security issues are greatly reduced.</p>
<p><strong>The system</strong> contains everything not directly related
to hardware or graphical interface. Examples of this
are applications, user accounts, and permission management.</p>
<p><strong>The desktop environment</strong> is what the user sees from the launch of LapisOS.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="frequently-asked-questions"><a class="header" href="#frequently-asked-questions">Frequently Asked Questions</a></h1>
<ul>
<li><a href="FAQ.html#frequently-asked-questions">Frequently Asked Questions</a>
<ul>
<li><a href="FAQ.html#will-this-project-replace-windowsmacoslinux-one-day">Will this project replace Windows/macOS/Linux/... one day?</a></li>
<li><a href="FAQ.html#how-can-i-help">How can I help?</a></li>
</ul>
</li>
</ul>
<h2 id="will-this-project-replace-windowsmacoslinux-one-day"><a class="header" href="#will-this-project-replace-windowsmacoslinux-one-day">Will this project replace Windows/macOS/Linux/... one day?</a></h2>
<p>No, it's impossible. Because ignoring backward compatibility
for legacy architectures and already existing software is
simply not viable for an operating system. Users first
look at applications in an operating system, <strong>then</strong> the system
itself - for security, stability, performance, etc.</p>
<p>Imagine that someone offers you a great operating system, but
there are almost no applications in it. Would you still use
this OS instead of Windows/macOS/Linux? Of course no!</p>
<p>That's why this project is <strong>purely theoretical</strong>.</p>
<h2 id="how-can-i-help"><a class="header" href="#how-can-i-help">How can I help?</a></h2>
<p>Help is very welcome but there's not many things to help with currently,
as the system is still being designed. You can still help by suggesting
improvements or fixing an error (whatever it is, a design problem or a simple typo)
by <a href="https://github.com/lapis-org/docs/issues/new/choose">submitting an issue</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="project"><a class="header" href="#project">Project</a></h1>
<p>This folder contains the documentation about the proejct itself.</p>
<ul>
<li><a href="project/development.html">Development</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development"><a class="header" href="#development">Development</a></h1>
<ul>
<li><a href="project/development.html#development">Development</a>
<ul>
<li><a href="project/development.html#languages">Languages</a></li>
</ul>
</li>
</ul>
<h2 id="languages"><a class="header" href="#languages">Languages</a></h2>
<p>The project will be developed in <a href="https://www.rust-lang.org/">RustÂ®</a>,
with first-class support for this language.</p>
<p>The use of architecture-specific Assembly will be reduced
as much as possible and will only be used in the following two cases:</p>
<ul>
<li>Targeted behavior cannot be achieved without
Assembly (e.g. registers and stack manipulation)</li>
<li>Extremely performance-critical parts</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="concepts"><a class="header" href="#concepts">Concepts</a></h1>
<p>This folder contains the high-level documents of LapisOS.
It is written in a way that readers can easily understand.</p>
<ul>
<li><a href="concepts/applications.html">What are applications?</a> - the way to run software on LapisOS</li>
<li><a href="concepts/libraries.html">What are libraries?</a> -  sharing identical behaviours between multiple applications</li>
<li><a href="concepts/users.html">What are users?</a> - sharing a computer between multiple persons </li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-are-applications"><a class="header" href="#what-are-applications">What are applications?</a></h1>
<p><em>Applications</em> are the way the operating system processes software.</p>
<ul>
<li><a href="concepts/applications.html#what-are-applications">What are applications?</a>
<ul>
<li><a href="concepts/applications.html#how-applications-work">How applications work?</a></li>
<li><a href="concepts/applications.html#installation-methods">Installation Methods</a>
<ul>
<li><a href="concepts/applications.html#from-the-store">From the store</a></li>
<li><a href="concepts/applications.html#sideloading">Sideloading</a></li>
<li><a href="concepts/applications.html#volatile-applications">Volatile applications</a></li>
</ul>
</li>
<li><a href="concepts/applications.html#commands">Commands</a></li>
<li><a href="concepts/applications.html#system-applications">System Applications</a></li>
<li><a href="concepts/applications.html#services">Services</a></li>
</ul>
</li>
</ul>
<h2 id="how-applications-work"><a class="header" href="#how-applications-work">How applications work?</a></h2>
<p>An application basically consists of executable files and resources.
Because binary programs are not supported directly, <strong>applications are the only way to run code</strong>.</p>
<h2 id="installation-methods"><a class="header" href="#installation-methods">Installation Methods</a></h2>
<p>All applications are installed through <em>application packages</em>.
There are several installation methods:</p>
<ul>
<li>From the store</li>
<li>Directly from the app's package</li>
<li>As a volatile application</li>
</ul>
<h3 id="from-the-store"><a class="header" href="#from-the-store">From the store</a></h3>
<p>Applications can be downloaded and installed from the official store of LapisOS.</p>
<p><strong>For closed source applications</strong>, the store only provides precompiled programs.</p>
<p><strong>For open source applications</strong>, the store provides both precompiled
programs and support for compiling from source.</p>
<p>Users can compile applications from source using the appropriate tools
to compile, or simply use precompiled programs (default) and change
the default option at any time.</p>
<h3 id="sideloading"><a class="header" href="#sideloading">Sideloading</a></h3>
<p><em>Sideloading (installing an application directly from its package)</em> follows
certain rules set by the sideloading mode, called &quot;disable&quot;, &quot;secure&quot;, &quot;insecure&quot;.</p>
<ul>
<li><strong>Disable mode</strong> blocks all sideloading, in this mode it is not possible to install apps via packages, but <a href="concepts/applications.html#volatile-applications">volatile apps</a> can still be run.</li>
<li><strong>Safe mode</strong> allows sideloading and makes the system check if the application's AID matches an appllication available in the Store. If it matches, it compares the signature of the application with the signature of the Store Application. If the signatures do not match, the application is considered <em>malicious</em> and will not be installed. Also note that this mod only works when the computer is connected to the internet, as the system needs to check the Store to see if the application is malicios. If the computer is offline, sideloading will be disabled.</li>
<li><strong>Insecure mode</strong> allows sideloading without any checking, which is quite dangerous as it allows spoofing.</li>
</ul>
<p>Sideloading mode can be changed in Control Center.</p>
<h3 id="volatile-applications"><a class="header" href="#volatile-applications">Volatile applications</a></h3>
<p>Applications can also be run as <em>volatile applications</em>, which
means they are not installed to disk:</p>
<ul>
<li><strong>Full-volatile:</strong> all data of the application is deleted after the application is closed</li>
<li><strong>Session-scoped:</strong> the application's data is kept on disk until the system is shut down</li>
<li><strong>Local-persisent:</strong> the application's data is stored in a data file with extension <code>*.vad</code> created in the same folder</li>
<li><strong>Persistent:</strong> the application's data is stored in a dedicated folder</li>
</ul>
<p>By default, volatile applications run in <em>local-persistent</em> mode.
In this mode, the system first searches for a file in the same
folder with the same name as the application's package file,
but with the extension <code>*.vad</code> <em>(Volatile Application Data)</em>.
If the file is found, it opens it as the application's storage.
Thus, when the application wants to store data, it is stored in the data file.</p>
<p>Note that <code>*.vad</code> <em>(Volatile Application Data)</em> files are disguised
VSF (Virtual Storage File) files.</p>
<p><em>Persistently running apps</em> are not listed in the app list and can only be
managed through an option in the Control Center. While its data is stored
on disk, its executables are not stored anywhere, they just stay inside
the package. This allows running the same application multiple times and
not worrying about the data file. It also supports shared data storage between users.</p>
<p>Note that the store has an option for installing applications as volatile.</p>
<h2 id="commands"><a class="header" href="#commands">Commands</a></h2>
<p>Applications can provide shell commands. Since command names must prefixed
by the AID, multiple commands can be provided without the danger of name conflicts.</p>
<p>For example, if an app with AID <code>developer.app</code> provides the command <code>get_time</code>, the last available command will be <code>developer.app.get_time</code>.</p>
<p>Although this is a rather long name, it avoids conflicts between
the names of the commands. It is quite common for shell scripts to
import commands at the beginning of the script to make it easier
to access applications' commands.</p>
<p>By default, shell prompts (not scripts) will allow use directly
in the short form <code>get_time</code> if no other application provides
a command with the same name.</p>
<p>Commands work by running the application through a specific <em>execution context</em>.</p>
<h2 id="system-applications"><a class="header" href="#system-applications">System Applications</a></h2>
<p>Some native applications are part of the system itself and
are called <em>system applications</em>. These applications have some special privileges:</p>
<ul>
<li>Access to system-reserved features</li>
<li>Permission to create <em>system service</em></li>
<li>They cannot be uninstalled</li>
</ul>
<p>System applications cannot be removed <em>by any means</em> as
they are critical to the correct functioning of the system.
Native applications which are not system applications can be removed, though.</p>
<h2 id="services"><a class="header" href="#services">Services</a></h2>
<p>Applications can create <em>services</em> by specifying them in their manifests.
The services will run at startup with the application's permissions.</p>
<p>There is exactly one process for each service per active user.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-are-libraries"><a class="header" href="#what-are-libraries">What are libraries?</a></h1>
<ul>
<li><a href="concepts/libraries.html#what-are-libraries">What are libraries?</a>
<ul>
<li><a href="concepts/libraries.html#how-libraries-work">How libraries work?</a></li>
</ul>
</li>
</ul>
<h2 id="how-libraries-work"><a class="header" href="#how-libraries-work">How libraries work?</a></h2>
<p>Unlike applications, libraries can be installed in multiple
versions. This means you can have three versions of the same
library installed at the same time on your computer.</p>
<p>When an application wants to use a library, it explicitly indicates
the list of versions it is compatible with. The system gets the related
version and provides it to the application.</p>
<p>A library by itself cannot do itself; no background process, no commands
exposure, no permission granting. Applications simply use libraries as
helpers to achieve specific tasks.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-are-users"><a class="header" href="#what-are-users">What are users?</a></h1>
<ul>
<li><a href="concepts/users.html#what-are-users">What are users?</a>
<ul>
<li><a href="concepts/users.html#the-concept">The concept</a></li>
<li><a href="concepts/users.html#users-type">Users type</a></li>
<li><a href="concepts/users.html#dangers-of-an-administrator-account">Dangers of an administrator account</a></li>
<li><a href="concepts/users.html#user-privileges-elevation-upe">User Privileges Elevation (UPE)</a></li>
<li><a href="concepts/users.html#groups">Groups</a></li>
</ul>
</li>
</ul>
<h2 id="the-concept"><a class="header" href="#the-concept">The concept</a></h2>
<p>Most computers are intended to be shared among many people.
In such a situation it is quite useful to separate each user's
data from each other and restrict access to the other.</p>
<p>By default, there are two user accounts: the <em>System</em> and the <em>Administrator</em>.
They are called <em>virtual users</em> because it is not possible to log in these accounts.
Other users are called <em>custom users</em>.</p>
<p>Each custom user has a data folder called <em>home directory</em> designated as <code>/home/[username]</code>.
Users can access the files and folders inside this folder and do whatever they want.
By default, each user has access to:</p>
<ul>
<li>Its home directory in <code>/home/[username]</code></li>
<li>The mounted units in <code>/media</code></li>
<li>Its temporary directory in <code>tmp/[username]</code></li>
</ul>
<h2 id="users-type"><a class="header" href="#users-type">Users type</a></h2>
<p>Each user is in one of these types:</p>
<ul>
<li><strong>Phantom:</strong> all data of the user is deleted after the computer is turned off</li>
<li><strong>Standard:</strong> nothing special</li>
<li><strong>Administrator:</strong> can run programs directly as administrator</li>
<li><strong>Main administrator:</strong> administrator account that can manage storage encryption</li>
</ul>
<p>When a user wants to perform a task for which he is not authorized,
it may want to run the task as another user. The other user's login
informations are required then.</p>
<p>A task cannot be performed as system or administrator because these
accounts are virtual and have no passwords, <strong>except</strong> if an administrator
user tries to run a task as administrator.</p>
<p>Keep in mind that there is always only one and exactly one administrator.
This account is created during the installation process and can later be transferred
to another administrator account.</p>
<h2 id="dangers-of-an-administrator-account"><a class="header" href="#dangers-of-an-administrator-account">Dangers of an administrator account</a></h2>
<p>The problem with the administrator account is that <strong>it can do anything</strong> (except
some very specific things). They can change system settings, read and modify other users'
data, and even run background processes on startup.
They also have all possible permissions.</p>
<p>Having two administrator accounts on one computer is <strong>definitely</strong> not
recommended unless both accounts are used by trusted people. For this reason,
a large warning is shown when you try to create a new administrator account.</p>
<h2 id="user-privileges-elevation-upe"><a class="header" href="#user-privileges-elevation-upe">User Privileges Elevation (UPE)</a></h2>
<p>Users can request permission to run a task as another user, such as running as administrator.</p>
<p>In such a case, the program is still run as the same user, but with the same user's
privileges and the user's privileges specified to the UPE.</p>
<p>To run a program with UPE, either knowing the user's password or <em>authorization</em>
from this user is required. For example, administrator accounts are <em>authorized</em>
to use the Administrator account without specifying a password.</p>
<p>Successful or not, every request is logged in the log file at <code>/etc/logs/auc</code>.</p>
<h2 id="groups"><a class="header" href="#groups">Groups</a></h2>
<p>Groups are a set of privileges defined by the administrator. Access some folders or application's permissions (e.g. microphone access) can be restricted to a specific group, for instance. When a user is created, it can be put in a group. It then automatically inherits all of the group's privileges, in addition to its own ones. The administrator can add and remove users from groups with the control panel.</p>
<p>When a user is in a group, the group's privileges cannot be revoked for this user.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
